const g=document.querySelector("#startAudio"),_=document.querySelector(".js_intro"),V=document.querySelector("#introStart"),F=document.querySelector(".js_gameover"),W=document.querySelector("#gameoverRestart"),o=document.querySelectorAll(".js_heart"),c=document.querySelector(".js_bat"),d=document.querySelectorAll(".js_foodBtn"),I=document.querySelector(".tamagotchi__foods"),z=document.querySelector(".js_dpad-up"),J=document.querySelector(".js_dpad-down"),Q=document.querySelector(".js_dpad-left"),X=document.querySelector(".js_dpad-right"),Y=document.querySelector(".js_btn-a"),Z=document.querySelector(".js_btn-b"),$=document.querySelector(".js_select-btn"),ee=document.querySelector(".js_reset-btn"),te=["heart--full","heart--half","heart--empty"],n={normal:"bat--normal",sad:"bat--sad",hungry:"bat--hungry",dead:"bat--dead",eating:"bat--eating",love:"bat--love",no:"bat--no",paused:"bat--paused"},R=1e4,ae=2100,w=1e3;let l=o.length-1,t=0,r=0,b=null,i=!1,m=!1,v=0;const D=new Audio("/sounds/heart-down.mp3"),a=new Audio("/sounds/background.ogg"),q=new Audio("/sounds/game-start.mp3");a.loop=!0;a.volume=.2;function p(e,u){e.classList.remove("heart--full","heart--half","heart--empty"),e.classList.add(te[u])}function s(e){c.classList.remove("bat--normal","bat--sad","bat--hungry","bat--dead","bat--eating","bat--love","bat--no","bat--paused"),c.classList.add(e)}function T(e){e.classList.add("heart--anim"),setTimeout(()=>e.classList.remove("heart--anim"),300)}function y(){clearInterval(b),b=null}function L(){b||(b=setInterval(E,R))}function k(e){return new Promise(u=>setTimeout(u,e))}function S(){return r>=o.length}function ne(){F.classList.add("gameover--visible")}function M(){i||S()||(i=!0,y(),s(n.paused),O(!0),f())}function O(e){d.forEach(u=>{u.style.pointerEvents=e?"none":"auto",u.style.opacity=e?"0.4":"1"})}function x(){!i||S()||(i=!1,s(h()),L(),O(!1),y(),L())}function j(){y(),f(),F.classList.remove("gameover--visible"),l=o.length-1,t=0,r=0,i=!1,o.forEach(e=>p(e,0)),s(n.normal),c.dataset.busy="false",a.pause(),a.currentTime=0,a.src="/sounds/background.ogg",(!a.paused||g.innerHTML.includes("volume-xmark"))&&a.play(),L()}function G(){m||i||S()||(m=!0,I.classList.add("tamagotchi__foods--visible"),v=0,A())}function f(){m=!1,I.classList.remove("tamagotchi__foods--visible"),d.forEach(e=>e.classList.remove("tamagotchi__food-button--selected"))}function A(){d.forEach((e,u)=>{u===v?e.classList.add("tamagotchi__food-button--selected"):e.classList.remove("tamagotchi__food-button--selected")})}function U(){m&&(v=(v-1+d.length)%d.length,A())}function C(){m&&(v=(v+1)%d.length,A())}function N(){if(!m)return;const e=d[v].dataset.food;K(e),f()}function E(){if(i||l<0)return;const e=o[l];t===0?(p(e,1),T(e),D.play(),t=1):t===1?(p(e,2),T(e),D.play(),t=2,r++,r>=o.length?(s(n.dead),a.pause(),a.src="/sounds/game-over.mp3",a.play(),setTimeout(()=>{ne()},1500)):H()):(l--,t=0,E())}function B(){E()}function P(){if(!(r===0&&t===0)){if(t===2)p(o[l],1),t=1,r--;else if(t===1)p(o[l],0),t=0;else{l++,t=2,P();return}H()}}function se(){o.forEach(e=>p(e,0)),l=o.length-1,t=0,r=0,H()}function re(){return r===0&&t===0}function h(){return r>=o.length?n.dead:r===2?n.hungry:r===1?n.sad:n.normal}function oe(){return r===o.length-1&&t===1}function H(){c.dataset.busy!=="true"&&s(h())}async function K(e){if(!i&&c.dataset.busy!=="true"&&h()!==n.dead){if(re()&&(e==="melon"||e==="moth")){c.dataset.busy="true",y(),s(n.no),await k(w),s(h()),c.dataset.busy="false",L();return}if(c.dataset.busy="true",y(),e==="ajo"&&oe()){B(),c.dataset.busy="false";return}s(n.eating),await k(ae),e==="ajo"?(B(),s(n.no),await k(w)):e==="melon"?P():(se(),s(n.love),await k(w)),s(h()),c.dataset.busy="false",L()}}g.innerHTML='<i class="fa-solid fa-volume-xmark"></i>';g.addEventListener("click",()=>{a.paused?(a.play(),g.innerHTML='<i class="fa-solid fa-volume-xmark"></i>'):(a.pause(),g.innerHTML='<i class="fa-solid fa-volume-high"></i>')});V.addEventListener("click",()=>{_.classList.add("intro--closing"),q.volume=.5,q.play(),q.addEventListener("ended",()=>a.play(),{once:!0}),_.addEventListener("animationend",()=>{_.style.display="none",s(n.normal),b=setInterval(E,R)},{once:!0})});W.addEventListener("click",()=>{j()});d.forEach(e=>{e.addEventListener("click",()=>{m&&(K(e.dataset.food),f())})});z.addEventListener("click",()=>{G()});J.addEventListener("click",()=>{f()});Q.addEventListener("click",()=>{U()});X.addEventListener("click",()=>{C()});Y.addEventListener("click",()=>{N()});Z.addEventListener("click",()=>{f()});$.addEventListener("click",()=>{S()||(i?x():M())});ee.addEventListener("click",()=>{confirm("¿Estás seguro de que quieres reiniciar el juego? Se perderá todo el progreso.")&&j()});document.addEventListener("keydown",e=>{switch(e.key){case"ArrowUp":case"w":case"W":e.preventDefault(),G();break;case"ArrowDown":case"s":case"S":e.preventDefault(),f();break;case"ArrowLeft":case"a":case"A":e.preventDefault(),U();break;case"ArrowRight":case"d":case"D":e.preventDefault(),C();break;case"Enter":case" ":e.preventDefault(),N();break;case"Escape":case"Backspace":e.preventDefault(),f();break;case"p":case"P":if(e.preventDefault(),S())return;i?x():M();break;case"r":case"R":e.preventDefault(),confirm("¿Estás seguro de que quieres reiniciar el juego? Se perderá todo el progreso.")&&j();break}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOltdLCJzb3VyY2VzQ29udGVudCI6W10sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIifQ==
